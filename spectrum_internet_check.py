""" Checks for spectrum/charter service and can itterate of an array
    of aparmtent numbers.
"""

from datetime import datetime

import json
import queue
import urllib.request

filename = 'results_'+datetime.now().strftime("%Y-%m-%d_%H.%M.%S")
 
f = open(filename,'w')
f.write("Street, APT, City, State, Zip, Existing Service\n")
f.close()


street = '123 Somewhere Drive'
zip = '555555'
city = 'Somecity'
state = 'NY'
apt_numbers = {111, 210, 211, 212, 213, 214,215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 310, 311,312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430,431, 432, 433, 434, 435, 436, 437, 438, 439, 510, 511, 512, 513, 514, 515, 516, 517, 518, 519, 520, 521, 522, 523, 524, 525, 526, 527, 528, 529, 530, 531, 532, 533, 534, 535, 536, 537, 538, 539, 611, 612, 613, 614, 615, 616, 617, 618, 621, 622, 623, 624, 625, 626, 627, 628, 632, 633, 636, 637, 711, 712, 713, 714, 715, 716, 717, 718,721, 722, 723, 724, 725, 726, 727, 728, 732,733, 736, 737, 760, 810, 811, 812, 813, 814, 815, 816, 817, 818, 819, 820, 821, 822, 823, 824, 825, 826, 827, 829, 830, 831, 832, 833, 834, 835, 836, 837, 838, 839, 911, 912, 913, 914, 915, 916, 917, 918, 921, 922, 923, 924, 925, 926, 927, 928, 931, 932, 933, 934, 935, 936, 937, 938, 1010, 1011, 1012, 1013, 1014, 1015, 1016, 1017, 1018, 1019,1020, 1021, 1022, 1023, 1024, 1025, 1026, 1027, 1028, 1029, 1030, 1031, 1032, 1033, 1034, 1035, 1036, 1037, 1038, 1039, 1110, 1111, 1112, 1113, 1114, 1115, 1116, 1117, 1118, 1119, 1120, 1121, 1122, 1123, 1124, 1125, 1126, 1127, 1128, 1129, 1130, 1131, 1132, 1133, 1134, 1135, 1136, 1137, 1138, 1139, 1211, 1212, 1213, 1214, 1215, 1216, 1217, 1218, 1221, 1222, 1223, 1224, 1225, 1226, 1227, 1228, 1231, 1232, 1233, 1234, 1235, 1236, 1237, 1238, 1311, 1312, 1313, 1314, 1315, 1316, 1317, 1318, 1321, 1322, 1323, 1324, 1325,1326, 1327, 1328, 1331, 1332, 1333, 1334, 1335, 1336, 1337, 1338, 1411, 1412, 1413, 1414, 1415, 1416, 1417, 1418,1421, 1422, 1423, 1424, 1425, 1426, 1427, 1428, 1431, 1432, 1433, 1434, 1435, 1436,1437,1438, 1510, 1511, 1512, 1513, 1514, 1515, 1516, 1517, 1518, 1519,1520, 1521, 1522, 1523,1524, 1525, 1526, 1527, 1528, 1529, 1530, 1531,1533, 1534,1535, 1536, 1537, 1538, 1539, 1610, 1611,1612, 1613,1614, 1615, 1616,1617, 1618, 1619, 1620, 1621, 1622, 1623, 1624, 1625, 1626, 1627, 1628, 1629, 1630, 1631, 1632,1633, 1634, 1635, 1636, 1637, 1638, 1639, 1710, 1711, 1712, 1713, 1714, 1715, 1716, 1717, 1718, 1719, 1720, 1721, 1722, 1723, 1724, 1725, 1726, 1727, 1728, 1729,1730, 1731, 1732, 1733, 1734, 1735, 1736, 1737, 1738, 1739, 1811,1812, 1813, 1814, 1815, 1821,1822,1823, 1824, 1825, 1831,1832, 1833, 1834, 1835, 2391}

for i in {212}:
    url = 'https://www.spectrum.com/api/serviceabilityaddresses/v1/serviceabilityaddress?line1=7601%20Churchill%20Way%20Apt%20' + str(i) + '&line2=&postalCode=75251'
    req = urllib.request.Request(url=url, method='GET')
    resp = urllib.request.urlopen(req)
    respobj = json.loads(resp.read().decode('utf-8'))
    existing = respobj['content'][0]['serviceStatus']
    print(json.dumps(respobj, indent=4))
    line = '%s, %s, %s, %s, %s, %s' % \
                    (street, str(i), city, state, zip, existing)
    print(line)
    f = open(filename,'a')
    f.write(line + '\n')
    f.close()
